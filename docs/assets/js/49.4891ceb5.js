(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{364:function(_,v,t){"use strict";t.r(v);var r=t(18),a=Object(r.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h1",{attrs:{id:"从输入url到页面展示的完整过程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#从输入url到页面展示的完整过程"}},[_._v("#")]),_._v(" 从输入URL到页面展示的完整过程")]),_._v(" "),v("h2",{attrs:{id:"_1-现代浏览器架构"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-现代浏览器架构"}},[_._v("#")]),_._v(" 1. 现代浏览器架构")]),_._v(" "),v("p",[_._v("现代浏览器采用多进程架构模型，以提高稳定性和安全性。以Chrome浏览器为例，主要包括以下进程：")]),_._v(" "),v("ol",[v("li",[v("strong",[_._v("浏览器进程")]),_._v("：负责浏览器界面显示、用户交互、子进程管理等")]),_._v(" "),v("li",[v("strong",[_._v("渲染进程")]),_._v("：负责页面渲染，包括HTML解析、CSS样式计算、JavaScript执行等")]),_._v(" "),v("li",[v("strong",[_._v("网络进程")]),_._v("：负责网络资源加载，处理HTTP请求和响应")]),_._v(" "),v("li",[v("strong",[_._v("GPU进程")]),_._v("：负责图形绘制和硬件加速")]),_._v(" "),v("li",[v("strong",[_._v("插件进程")]),_._v("：负责运行各种浏览器插件，隔离插件崩溃对浏览器的影响")])]),_._v(" "),v("p",[_._v("每个标签页通常会有一个独立的渲染进程，这样即使一个页面崩溃也不会影响其他页面。这种架构设计提高了浏览器的稳定性和安全性。")]),_._v(" "),v("p",[_._v("当我们在浏览器地址栏输入一个URL并按下回车键后，直到页面完全展示在我们面前，这中间经历了哪些步骤呢？这是一个经典的前端面试题，也是理解浏览器工作原理的重要知识点。了解这个过程不仅有助于我们编写更高效的代码，还能帮助我们进行性能优化。")]),_._v(" "),v("h2",{attrs:{id:"_2-url解析与dns查询"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-url解析与dns查询"}},[_._v("#")]),_._v(" 2. URL解析与DNS查询")]),_._v(" "),v("h3",{attrs:{id:"_2-1-用户输入"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-用户输入"}},[_._v("#")]),_._v(" 2.1 用户输入")]),_._v(" "),v("p",[_._v("用户输入内容，点击回车，这意味着当前页面需要关闭，会调用当前页面的"),v("code",[_._v("beforeunload")]),_._v("事件。此事件使网页能够触发一个确认对话框，询问用户是否真的要离开该页面。如果用户确认，浏览器将导航到新页面，否则导航将会取消；")]),_._v(" "),v("h3",{attrs:{id:"_2-2-url解析"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-url解析"}},[_._v("#")]),_._v(" 2.2 URL解析")]),_._v(" "),v("p",[_._v("URL（统一资源定位符）是互联网上资源的唯一标识。当用户输入URL后，浏览器首先需要解析URL的各个组成部分：")]),_._v(" "),v("ol",[v("li",[_._v("协议（如HTTP、HTTPS）")]),_._v(" "),v("li",[_._v("域名（如www.example.com）")]),_._v(" "),v("li",[_._v("端口号（如80、443）")]),_._v(" "),v("li",[_._v("路径（如/index.html）")]),_._v(" "),v("li",[_._v("查询参数（如?name=value）")]),_._v(" "),v("li",[_._v("片段标识符（如#section1）")])]),_._v(" "),v("p",[_._v("浏览器判断用户输入URL是否合法，如果不合法，则调用默认的搜索引擎，来合成新的带搜索关键字的URL")]),_._v(" "),v("h3",{attrs:{id:"_2-3-dns查询"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-dns查询"}},[_._v("#")]),_._v(" 2.3 DNS查询")]),_._v(" "),v("p",[_._v("解析完成后，浏览器需要将域名转换为IP地址，这个过程称为DNS查询。DNS查询的过程如下：")]),_._v(" "),v("ol",[v("li",[_._v("浏览器缓存：首先检查浏览器DNS缓存中是否有对应的IP地址")]),_._v(" "),v("li",[_._v("系统缓存：检查操作系统hosts文件")]),_._v(" "),v("li",[_._v("路由器缓存：查询路由器缓存")]),_._v(" "),v("li",[_._v("ISP DNS服务器：向本地ISP的DNS服务器查询")]),_._v(" "),v("li",[_._v("根DNS服务器：如果本地DNS服务器没有缓存，则向根DNS服务器查询")]),_._v(" "),v("li",[_._v("顶级域DNS服务器：根据域名后缀（如.com、.org）查询对应的DNS服务器")]),_._v(" "),v("li",[_._v("权威DNS服务器：最终查询到域名对应的IP地址")])]),_._v(" "),v("h3",{attrs:{id:"_2-4-dns查询优化建议"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-dns查询优化建议"}},[_._v("#")]),_._v(" 2.4 DNS查询优化建议")]),_._v(" "),v("ul",[v("li",[_._v("减少DNS查询次数：合并域名，减少页面中不同域名的资源引用")]),_._v(" "),v("li",[_._v("DNS预解析：使用"),v("code",[_._v('<link rel="dns-prefetch" href="//example.com">')]),_._v("标签提前解析域名")]),_._v(" "),v("li",[_._v("合理设置DNS缓存时间：通过TTL（Time To Live）控制缓存有效期")])]),_._v(" "),v("h2",{attrs:{id:"_3-建立tcp连接"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-建立tcp连接"}},[_._v("#")]),_._v(" 3. 建立TCP连接")]),_._v(" "),v("h3",{attrs:{id:"_3-1-建立tcp连接"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-建立tcp连接"}},[_._v("#")]),_._v(" 3.1 建立TCP连接")]),_._v(" "),v("p",[_._v("获取到服务器IP地址后，浏览器需要与服务器建立TCP连接。这个过程通过TCP三次握手完成：")]),_._v(" "),v("ol",[v("li",[_._v("客户端发送SYN包到服务器，请求建立连接")]),_._v(" "),v("li",[_._v("服务器回复SYN+ACK包，同意建立连接")]),_._v(" "),v("li",[_._v("客户端发送ACK包，确认连接建立")])]),_._v(" "),v("h3",{attrs:{id:"_3-2-tls握手过程-https协议"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-tls握手过程-https协议"}},[_._v("#")]),_._v(" 3.2 TLS握手过程（HTTPS协议）")]),_._v(" "),v("p",[_._v("如果是HTTPS协议，还需要进行TLS握手来建立安全连接：")]),_._v(" "),v("ol",[v("li",[v("strong",[_._v("Client Hello")]),_._v("：客户端发送支持的TLS版本、加密套件列表和一个随机数")]),_._v(" "),v("li",[v("strong",[_._v("Server Hello")]),_._v("：服务器选择TLS版本和加密套件，并发送服务器证书和另一个随机数")]),_._v(" "),v("li",[v("strong",[_._v("证书验证")]),_._v("：客户端验证服务器证书的有效性")]),_._v(" "),v("li",[v("strong",[_._v("密钥交换")]),_._v("：客户端生成预主密钥，使用服务器公钥加密后发送给服务器")]),_._v(" "),v("li",[v("strong",[_._v("会话密钥生成")]),_._v("：双方使用三个随机数生成会话密钥")]),_._v(" "),v("li",[v("strong",[_._v("握手完成")]),_._v("：双方交换Finished消息，确认握手完成，开始加密通信")])]),_._v(" "),v("h2",{attrs:{id:"_4-发送http请求"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_4-发送http请求"}},[_._v("#")]),_._v(" 4. 发送HTTP请求")]),_._v(" "),v("p",[_._v("TCP连接建立后，浏览器会构建HTTP请求报文并发送给服务器：")]),_._v(" "),v("ol",[v("li",[_._v("请求行：包含请求方法、URL、HTTP版本")]),_._v(" "),v("li",[_._v("请求头：包含User-Agent、Accept、Cookie等信息")]),_._v(" "),v("li",[_._v("请求体：POST等请求方法的数据体")])]),_._v(" "),v("h2",{attrs:{id:"_5-服务器处理与响应"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5-服务器处理与响应"}},[_._v("#")]),_._v(" 5. 服务器处理与响应")]),_._v(" "),v("h3",{attrs:{id:"_5-1-资源请求处理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-资源请求处理"}},[_._v("#")]),_._v(" 5.1 资源请求处理")]),_._v(" "),v("ul",[v("li",[_._v("网络进程查找浏览器缓存是否存在该资源，如果命中该资源且没有过期，直接返回资源给浏览器进程")]),_._v(" "),v("li",[_._v("如果没有命中缓存资源，直接进入网络请求流程")])]),_._v(" "),v("h3",{attrs:{id:"_5-2-请求处理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-请求处理"}},[_._v("#")]),_._v(" 5.2 请求处理")]),_._v(" "),v("p",[_._v("服务器接收到请求后进行处理：")]),_._v(" "),v("ol",[v("li",[_._v("服务器解析请求，定位资源")]),_._v(" "),v("li",[_._v("执行服务端逻辑（如数据库查询、业务处理等）")]),_._v(" "),v("li",[_._v("生成响应数据")]),_._v(" "),v("li",[_._v("构建HTTP响应报文返回给浏览器")])]),_._v(" "),v("h2",{attrs:{id:"_6-浏览器解析与渲染"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-浏览器解析与渲染"}},[_._v("#")]),_._v(" 6. 浏览器解析与渲染")]),_._v(" "),v("p",[_._v("服务器返回HTML内容后，浏览器开始解析和渲染页面。这个过程称为关键渲染路径（Critical Rendering Path）：")]),_._v(" "),v("h3",{attrs:{id:"_6-1-dom树构建"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-dom树构建"}},[_._v("#")]),_._v(" 6.1 DOM树构建")]),_._v(" "),v("ol",[v("li",[_._v("字节流转换：浏览器将接收到的HTML字节流转换为字符流")]),_._v(" "),v("li",[_._v("词法分析：将字符流转换为Token")]),_._v(" "),v("li",[_._v("语法分析：将Token转换为节点对象")]),_._v(" "),v("li",[_._v("构建DOM树：将节点对象组织成DOM树结构")])]),_._v(" "),v("h3",{attrs:{id:"_6-2-cssom树构建"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-cssom树构建"}},[_._v("#")]),_._v(" 6.2 CSSOM树构建")]),_._v(" "),v("ol",[v("li",[_._v("下载CSS文件：遇到"),v("code",[_._v("<link>")]),_._v("标签时下载CSS文件")]),_._v(" "),v("li",[_._v("解析CSS：将CSS文本解析为样式规则")]),_._v(" "),v("li",[_._v("构建CSSOM树：将样式规则组织成CSSOM树结构")])]),_._v(" "),v("h3",{attrs:{id:"_6-3-javascript执行"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-javascript执行"}},[_._v("#")]),_._v(" 6.3 JavaScript执行")]),_._v(" "),v("ol",[v("li",[_._v("下载JavaScript文件：遇到"),v("code",[_._v("<script>")]),_._v("标签时下载JS文件")]),_._v(" "),v("li",[_._v("解析和编译：将JS代码解析为抽象语法树并编译")]),_._v(" "),v("li",[_._v("执行：执行JS代码，可能会修改DOM和CSSOM")])]),_._v(" "),v("h3",{attrs:{id:"_6-4-渲染树构建"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-渲染树构建"}},[_._v("#")]),_._v(" 6.4 渲染树构建")]),_._v(" "),v("ol",[v("li",[_._v("从DOM树中筛选出可见节点")]),_._v(" "),v("li",[_._v("为每个可见节点匹配对应的CSS样式")]),_._v(" "),v("li",[_._v("构建渲染树（Render Tree）")])]),_._v(" "),v("h3",{attrs:{id:"_6-5-布局计算"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-布局计算"}},[_._v("#")]),_._v(" 6.5 布局计算")]),_._v(" "),v("ol",[v("li",[_._v("计算每个渲染对象的几何信息（位置、大小）")]),_._v(" "),v("li",[_._v("处理CSS盒模型和定位")])]),_._v(" "),v("h3",{attrs:{id:"_6-6-绘制"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-绘制"}},[_._v("#")]),_._v(" 6.6 绘制")]),_._v(" "),v("ol",[v("li",[_._v("将渲染树中的每个节点绘制到屏幕上")]),_._v(" "),v("li",[_._v("按照层叠顺序绘制元素")])]),_._v(" "),v("h3",{attrs:{id:"_6-7-合成"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_6-7-合成"}},[_._v("#")]),_._v(" 6.7 合成")]),_._v(" "),v("ol",[v("li",[_._v("将多个图层合成为最终图像")]),_._v(" "),v("li",[_._v("利用GPU加速提升性能")])]),_._v(" "),v("h2",{attrs:{id:"_7-性能优化建议"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_7-性能优化建议"}},[_._v("#")]),_._v(" 7. 性能优化建议")]),_._v(" "),v("p",[_._v("为了提升页面加载速度和用户体验，可以从以下几个方面进行优化：")]),_._v(" "),v("h3",{attrs:{id:"_7-1-资源优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-资源优化"}},[_._v("#")]),_._v(" 7.1 资源优化")]),_._v(" "),v("ul",[v("li",[v("strong",[_._v("减少HTTP请求")]),_._v("：合并CSS、JavaScript文件，使用CSS Sprites")]),_._v(" "),v("li",[v("strong",[_._v("压缩资源")]),_._v("：压缩HTML、CSS、JavaScript文件，启用Gzip压缩")]),_._v(" "),v("li",[v("strong",[_._v("图片优化")]),_._v("：使用适当的图片格式（WebP、AVIF），实施响应式图片")]),_._v(" "),v("li",[v("strong",[_._v("字体优化")]),_._v("：使用"),v("code",[_._v("font-display: swap")]),_._v("避免字体加载阻塞渲染")])]),_._v(" "),v("h3",{attrs:{id:"_7-2-网络优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-网络优化"}},[_._v("#")]),_._v(" 7.2 网络优化")]),_._v(" "),v("ul",[v("li",[v("strong",[_._v("使用CDN")]),_._v("：将静态资源部署到CDN上，减少网络延迟")]),_._v(" "),v("li",[v("strong",[_._v("启用缓存")]),_._v("：合理设置HTTP缓存头，利用浏览器缓存")]),_._v(" "),v("li",[v("strong",[_._v("预加载资源")]),_._v("：使用"),v("code",[_._v('<link rel="preload">')]),_._v("提前加载关键资源")]),_._v(" "),v("li",[v("strong",[_._v("DNS预解析")]),_._v("：使用"),v("code",[_._v('<link rel="dns-prefetch">')]),_._v("提前解析域名")])]),_._v(" "),v("h3",{attrs:{id:"_7-3-渲染优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-渲染优化"}},[_._v("#")]),_._v(" 7.3 渲染优化")]),_._v(" "),v("ul",[v("li",[v("strong",[_._v("关键资源优化")]),_._v("：减少关键资源数量和大小，优化关键路径长度")]),_._v(" "),v("li",[v("strong",[_._v("CSS优化")]),_._v("：将关键CSS内联，非关键CSS异步加载")]),_._v(" "),v("li",[v("strong",[_._v("JavaScript优化")]),_._v("：使用"),v("code",[_._v("async")]),_._v("或"),v("code",[_._v("defer")]),_._v("属性，避免阻塞HTML解析")]),_._v(" "),v("li",[v("strong",[_._v("服务端渲染")]),_._v("：对于复杂应用，考虑使用SSR提升首屏渲染速度")])]),_._v(" "),v("h2",{attrs:{id:"_8-连接结束"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_8-连接结束"}},[_._v("#")]),_._v(" 8. 连接结束")]),_._v(" "),v("p",[_._v("页面渲染完成后，浏览器可能会保持与服务器的连接（HTTP Keep-Alive），以便后续请求复用连接，减少连接建立的开销。")]),_._v(" "),v("h2",{attrs:{id:"_9-参考文章"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_9-参考文章"}},[_._v("#")]),_._v(" 9. 参考文章")]),_._v(" "),v("p",[v("a",{attrs:{href:"https://stackoverflow.com/questions/2092527/what-happens-when-you-type-in-a-url-in-browser",target:"_blank",rel:"noopener noreferrer"}},[_._v("What happens when you type a URL into your browser?"),v("OutboundLink")],1)]),_._v(" "),v("p",[v("a",{attrs:{href:"https://www.html5rocks.com/en/tutorials/internals/howbrowserswork/",target:"_blank",rel:"noopener noreferrer"}},[_._v("How Browsers Work: Behind the scenes of modern web browsers"),v("OutboundLink")],1)]),_._v(" "),v("p",[v("a",{attrs:{href:"https://developer.chrome.com/blog/inside-browser-part1/",target:"_blank",rel:"noopener noreferrer"}},[_._v("Chrome浏览器架构演进"),v("OutboundLink")],1)]),_._v(" "),v("p",[v("a",{attrs:{href:"https://developers.google.com/web/fundamentals/performance/critical-rendering-path",target:"_blank",rel:"noopener noreferrer"}},[_._v("关键渲染路径详解"),v("OutboundLink")],1)])])}),[],!1,null,null,null);v.default=a.exports}}]);